# PDF合并单元格样式更新说明

## 🎯 更新概述

根据用户反馈，已移除PDF中合并单元格的所有特殊样式，使其与普通单元格完全一致。

## 🔄 修改内容

### 修改前
```typescript
// PDF中合并单元格有浅蓝色背景
...(isMerged ? { 
  fillColor: [240, 248, 255], // 浅蓝色背景
} : {})
```

### 修改后
```typescript
// PDF中合并单元格无特殊样式
// 移除合并单元格的特殊样式，保持与普通单元格完全一致
// ...(isMerged ? { 
//   fillColor: [240, 248, 255], // 浅蓝色背景
// } : {})
```

## 📊 样式对比

| 场景 | 页面表格 | PDF预览/导出 |
|------|----------|--------------|
| **合并单元格** | 蓝色边框 + 浅蓝背景 | 无特殊样式 |
| **普通单元格** | 标准样式 | 标准样式 |
| **视觉效果** | 突出合并状态 | 专业简洁 |

## ✅ 功能保持

### 合并功能完全正常
- ✅ **自动合并**：相同内容的相邻行自动合并
- ✅ **手动合并**：支持右键菜单操作
- ✅ **rowSpan支持**：真正的HTML合并单元格
- ✅ **内容同步**：页面和PDF保持一致

### 移除的只是视觉样式
- ❌ **浅蓝色背景**：已移除
- ❌ **蓝色边框**：已移除
- ✅ **合并逻辑**：完全保留
- ✅ **跨行显示**：完全保留

## 🎨 设计理念

### 页面表格设计
- **目的**：帮助用户识别合并状态
- **样式**：蓝色边框 + 浅蓝背景
- **效果**：直观显示合并关系

### PDF输出设计
- **目的**：专业商务文档
- **样式**：无特殊样式
- **效果**：简洁专业，适合打印

## 📝 使用说明

### 页面操作
1. 输入相同内容的remarks会自动合并
2. 合并单元格显示蓝色边框和背景
3. 右键菜单支持手动合并/拆分

### PDF输出
1. 合并单元格在PDF中无特殊样式
2. 保持跨行显示功能
3. 内容与页面完全一致

## 🔧 技术实现

### 合并检测
```typescript
const calculateMergedCells = (items: LineItem[]): MergedCellInfo[] => {
  // 自动检测相邻相同内容的行
  // 返回合并单元格信息
};
```

### PDF生成
```typescript
// 在表格行生成时应用合并逻辑
if (showRemarks && shouldRenderRemarkCell(index, mergedCells)) {
  const mergedInfo = getMergedCellInfo(index, mergedCells);
  const rowSpan = mergedInfo ? mergedInfo.endRow - mergedInfo.startRow + 1 : 1;
  
  row.push({
    content: mergedInfo?.content || '',
    rowSpan: isMerged ? rowSpan : undefined,
    styles: {
      halign: 'center',
      // 无特殊样式，与普通单元格一致
    }
  });
}
```

## 📋 测试验证

### 功能测试
- [x] 自动合并功能正常
- [x] 手动合并功能正常
- [x] PDF生成正常
- [x] 合并状态同步正常

### 样式测试
- [x] 页面表格显示蓝色边框
- [x] PDF中无特殊样式
- [x] 跨行显示正常
- [x] 内容对齐正常

## 🚀 总结

这次更新：
1. **保持了所有合并功能**
2. **移除了PDF中的视觉样式**
3. **提升了PDF的专业外观**
4. **简化了视觉设计**

现在PDF输出更加简洁专业，适合商务文档使用。
