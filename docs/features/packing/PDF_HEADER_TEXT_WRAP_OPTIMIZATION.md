# Packing模块PDF表头文本换行优化

## 功能概述

针对packing模块PDF生成中表头文本在竖向模式下的显示问题，优化了表头文本的换行处理，特别是解决了"半个括号换行"的问题，确保表头文本在不同页面方向下都能正确显示。

## 主要优化

### 1. 括号换行问题解决
- **N.W.(kg)**: 竖向模式下换行为"N.W.\n(kg)"
- **G.W.(kg)**: 竖向模式下换行为"G.W.\n(kg)"
- **Dimensions(cm)**: 竖向模式下换行为"Dimensions\n(cm)"

### 2. 页面方向适配
- **竖向模式**: 使用换行文本，避免括号被分割
- **横向模式**: 保持单行文本，充分利用水平空间

### 3. 文本布局优化
- **换行位置**: 在括号前进行换行，确保括号完整性
- **视觉效果**: 保持表头的清晰度和可读性
- **空间利用**: 合理利用垂直空间

## 实现细节

### 1. 表头文本处理
```typescript
// 准备表头
const headers: string[][] = [[]];
if (showMarks) headers[0].push('Marks');
headers[0].push('No.');
if (showDescription) headers[0].push('Description');
if (showHsCode) headers[0].push('HS Code');
if (showQuantity) headers[0].push('Qty');
if (showUnit) headers[0].push('Unit');
if (showUnitPrice) headers[0].push('U/Price');
if (showAmount) headers[0].push('Amount');
if (showNetWeight) headers[0].push(isLandscape ? 'N.W.(kg)' : 'N.W.\n(kg)');
if (showGrossWeight) headers[0].push(isLandscape ? 'G.W.(kg)' : 'G.W.\n(kg)');
if (showPackageQty) headers[0].push('Pkgs');
if (showDimensions) headers[0].push(isLandscape ? `Dimensions(${data.dimensionUnit})` : `Dimensions\n(${data.dimensionUnit})`);
```

### 2. 换行策略
- **条件判断**: 根据`isLandscape`变量判断页面方向
- **换行位置**: 在括号前添加`\n`换行符
- **文本保持**: 保持括号的完整性和语义正确性

### 3. 布局适配
- **竖向模式**: 使用换行文本，避免文本过长
- **横向模式**: 使用单行文本，充分利用水平空间
- **动态调整**: 根据页面方向自动调整文本格式

## 优化效果

### 1. 文本显示
- **括号完整**: 避免括号被分割到不同行
- **语义清晰**: 保持文本的语义完整性
- **可读性**: 提高表头文本的可读性

### 2. 空间利用
- **竖向模式**: 合理利用垂直空间，避免文本过长
- **横向模式**: 充分利用水平空间，保持紧凑布局
- **整体协调**: 表头与表格内容的布局更加协调

### 3. 用户体验
- **视觉一致**: 不同页面方向下的视觉效果一致
- **信息完整**: 表头信息完整且清晰
- **专业外观**: 提升PDF文档的专业外观

## 使用场景

### 1. 竖向模式
- 当不显示marks列时，使用竖向模式
- 表头文本适当换行，避免过长
- 确保括号的完整性和可读性

### 2. 横向模式
- 当显示marks列时，使用横向模式
- 表头文本保持单行，充分利用水平空间
- 保持紧凑的表格布局

## 技术实现

### 1. 条件文本
- 使用三元运算符根据页面方向选择文本格式
- 在括号前添加换行符`\n`
- 保持文本的语义完整性

### 2. 换行处理
- 使用`\n`字符进行换行
- 确保换行位置合理，不影响语义
- 保持文本的可读性

### 3. 动态适配
- 根据`isLandscape`变量动态调整
- 自动选择最适合的文本格式
- 确保在不同页面方向下的最佳显示效果

## 更新日志

### 2025-01-08
- ✅ **PDF表头文本换行优化**: 解决竖向模式下表头文本的换行问题
- ✅ **括号换行修复**: 避免"N.W.(kg)"、"G.W.(kg)"等文本的括号被分割
- ✅ **页面方向适配**: 竖向模式使用换行文本，横向模式保持单行
- ✅ **文本布局优化**: 在括号前进行换行，确保括号完整性
- ✅ **视觉效果提升**: 提高表头文本的可读性和专业外观
- ✅ **空间利用优化**: 合理利用垂直和水平空间
